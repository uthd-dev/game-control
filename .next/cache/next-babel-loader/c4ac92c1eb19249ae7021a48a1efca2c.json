{"ast":null,"code":"import nextConnect from \"next-connect\";\nimport middleware from \"../../../../middleware/index\";\nimport passport from \"../../../../lib/auth/passport\";\nconst handler = nextConnect();\nhandler.use(middleware);\nhandler.get(passport.authenticate(\"twitch\", {\n  failureRedirect: \"/\"\n}), async (req, res) => {\n  var _req$session;\n\n  // Successful authentication, redirect home (default) or returnTo (from session), and reset returnTo.\n  if ((_req$session = req.session) === null || _req$session === void 0 ? void 0 : _req$session.returnTo) {\n    let returnTo = req.session.returnTo;\n    req.session.returnTo = \"/\";\n    res.redirect(`${process.env.hostUrl}${returnTo}`);\n  } else res.redirect(\"/\");\n});\nexport default handler;","map":null,"metadata":{},"sourceType":"module"}