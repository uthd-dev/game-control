{"ast":null,"code":"import nextConnect from 'next-connect';\nimport middleware from '../../../../middleware/index';\nimport passport from '../../../../lib/auth/passport';\nimport dbConnect from \"../../../../utils/dbConnect\";\nconst handler = nextConnect();\nhandler.use(middleware);\nhandler.get(async (req, res) => {\n  await dbConnect();\n  console.log(`Twitch Auth`);\n  if (req.query.returnTo) req.session.returnTo = `${req.query.returnTo}`;\n\n  function doVerify() {\n    if (req.query.verify) return req.query.verify == \"true\" ? true : false;\n  }\n\n  passport.authenticate(\"twitch\", {\n    forceVerify: doVerify()\n  })(req, res);\n});\nexport default handler;","map":{"version":3,"sources":["D:/Dev/GitHub/game-control/pages/api/auth/twitch/index.js"],"names":["nextConnect","middleware","passport","dbConnect","handler","use","get","req","res","console","log","query","returnTo","session","doVerify","verify","authenticate","forceVerify"],"mappings":"AAAA,OAAOA,WAAP,MAAwB,cAAxB;AACA,OAAOC,UAAP,MAAuB,8BAAvB;AACA,OAAOC,QAAP,MAAqB,+BAArB;AACA,OAAOC,SAAP,MAAsB,6BAAtB;AAGA,MAAMC,OAAO,GAAGJ,WAAW,EAA3B;AAEAI,OAAO,CAACC,GAAR,CAAYJ,UAAZ;AAEAG,OAAO,CAACE,GAAR,CAAY,OAAOC,GAAP,EAAYC,GAAZ,KAAoB;AAC5B,QAAML,SAAS,EAAf;AAEAM,EAAAA,OAAO,CAACC,GAAR,CAAa,aAAb;AACA,MAAGH,GAAG,CAACI,KAAJ,CAAUC,QAAb,EAAuBL,GAAG,CAACM,OAAJ,CAAYD,QAAZ,GAAwB,GAAEL,GAAG,CAACI,KAAJ,CAAUC,QAAS,EAA7C;;AAEvB,WAASE,QAAT,GAAoB;AAChB,QAAIP,GAAG,CAACI,KAAJ,CAAUI,MAAd,EAAsB,OAAOR,GAAG,CAACI,KAAJ,CAAUI,MAAV,IAAoB,MAApB,GAA6B,IAA7B,GAAoC,KAA3C;AACzB;;AAEDb,EAAAA,QAAQ,CAACc,YAAT,CAAsB,QAAtB,EAAgC;AAAEC,IAAAA,WAAW,EAAEH,QAAQ;AAAvB,GAAhC,EAA6DP,GAA7D,EAAkEC,GAAlE;AACH,CAXD;AAaA,eAAeJ,OAAf","sourcesContent":["import nextConnect from 'next-connect';\r\nimport middleware from '../../../../middleware/index';\r\nimport passport from '../../../../lib/auth/passport';\r\nimport dbConnect from \"../../../../utils/dbConnect\";\r\n\r\n\r\nconst handler = nextConnect();\r\n\r\nhandler.use(middleware);\r\n\r\nhandler.get(async (req, res) => {\r\n    await dbConnect()\r\n\r\n    console.log(`Twitch Auth`)\r\n    if(req.query.returnTo) req.session.returnTo = `${req.query.returnTo}`;\r\n\r\n    function doVerify() {\r\n        if (req.query.verify) return req.query.verify == \"true\" ? true : false;\r\n    }\r\n\r\n    passport.authenticate(\"twitch\", { forceVerify: doVerify() })(req, res);\r\n});\r\n\r\nexport default handler;"]},"metadata":{},"sourceType":"module"}